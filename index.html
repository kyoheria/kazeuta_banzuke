<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¢¨æ­Œç•ªä»˜ å‹æ‰‹ã«äºˆæƒ³ã‚µã‚¤ãƒˆ</title>
    <!-- Interãƒ•ã‚©ãƒ³ãƒˆã®èª­ã¿è¾¼ã¿ -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Sortable.js CDN for drag-and-drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* æ˜ã‚‹ã„ã‚°ãƒ¬ãƒ¼ã®èƒŒæ™¯ */
            color: #333; /* åŸºæœ¬çš„ãªãƒ†ã‚­ã‚¹ãƒˆè‰² */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* ç”»é¢å…¨ä½“ã‚’å ã‚ã‚‹ã‚ˆã†ã«ã™ã‚‹ */
            margin: 0;
            padding: 20px; /* å…¨ä½“ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff; /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ã®èƒŒæ™¯ */
            border-radius: 20px; /* è§’ã‚’ä¸¸ãã™ã‚‹ */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); /* å½±ã‚’è¿½åŠ  */
            padding: 40px; /* ã‚³ãƒ³ãƒ†ãƒŠå†…ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
            text-align: center;
            max-width: 900px; /* æœ€å¤§å¹…ã‚’å°‘ã—åºƒã’ã‚‹ */
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 30px; /* è¦ç´ é–“ã®ã‚¹ãƒšãƒ¼ã‚¹ */
        }
        h1 {
            color: #8B5CF6; /* ç´«è‰²ã®ã‚¿ã‚¤ãƒˆãƒ« */
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }
        h2 {
            color: #6B7280; /* ã‚°ãƒ¬ãƒ¼ã®ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ« */
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        p {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        .countdown-timer {
            font-size: 2.5rem;
            font-weight: 700;
            color: #EF4444; /* èµ¤è‰²ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ */
            margin-bottom: 30px;
            padding: 15px;
            background-color: #FEF2F2; /* è–„ã„èµ¤ã®èƒŒæ™¯ */
            border-radius: 10px;
            border: 2px solid #FCA5A5; /* è–„ã„èµ¤ã®ãƒœãƒ¼ãƒ€ãƒ¼ */
        }
        .action-area {
            margin-top: 20px;
        }
        .action-button {
            background-color: #8B5CF6; /* ç´«è‰²ã®ãƒœã‚¿ãƒ³ */
            color: white;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: 10px;
            text-decoration: none;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-block;
            box-shadow: 0 5px 15px rgba(139, 92, 246, 0.4); /* ãƒœã‚¿ãƒ³ã®å½± */
            cursor: pointer; /* ã‚«ãƒ¼ã‚½ãƒ«ã‚’ãƒã‚¤ãƒ³ã‚¿ãƒ¼ã« */
        }
        .action-button:hover {
            background-color: #7C3AED; /* ãƒ›ãƒãƒ¼æ™‚ã®è‰² */
            transform: translateY(-2px); /* å°‘ã—æµ®ãä¸ŠãŒã‚‹ */
        }
        .action-button:disabled {
            background-color: #A78BFA; /* ç„¡åŠ¹æ™‚ã®è‰² */
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }
        .footer {
            margin-top: 40px;
            font-size: 0.9rem;
            color: #6B7280;
        }
        .footer a {
            color: #8B5CF6;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }

        /* äºˆæƒ³æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã¨çµæœãƒšãƒ¼ã‚¸ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .page-section {
            display: none; /* åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º */
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 15px;
            background-color: #f9f9f9;
            text-align: left;
        }
        .page-section.active {
            display: block; /* ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º */
        }

        /* æ¥½æ›²é¸æŠUI */
        .song-list-container {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
        }
        .song-item {
            display: flex;
            align-items: center;
            padding: 8px 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        .song-item:last-child {
            border-bottom: none;
        }
        .song-item:hover {
            background-color: #f0f0f0;
        }
        .song-item input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ãƒªã‚¹ãƒˆ */
        .drag-drop-list {
            border: 2px dashed #8B5CF6;
            border-radius: 10px;
            min-height: 250px;
            padding: 15px;
            background-color: #F3F8FF; /* è–„ã„é’ã®èƒŒæ™¯ */
            margin-top: 20px;
        }
        .drag-drop-item {
            background-color: #E0E7FF; /* è–„ã„ç´«ã®èƒŒæ™¯ */
            color: #4338CA; /* æ¿ƒã„é’ã®ãƒ†ã‚­ã‚¹ãƒˆ */
            padding: 12px 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            cursor: grab;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .drag-drop-item:last-child {
            margin-bottom: 0;
        }
        .drag-drop-item .rank {
            font-size: 1.1em;
            margin-right: 10px;
            color: #6D28D9; /* ã‚ˆã‚Šæ¿ƒã„ç´« */
        }
        .drag-drop-item.sortable-chosen {
            background-color: #BFDBFE; /* ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®è‰² */
        }
        .drag-drop-item.sortable-ghost {
            opacity: 0.5;
            background-color: #D1D5DB;
        }

        /* æŠ•ç¨¿å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .confirmation-message {
            background-color: #D1FAE5; /* è–„ã„ç·‘ã®èƒŒæ™¯ */
            color: #065F46; /* æ¿ƒã„ç·‘ã®ãƒ†ã‚­ã‚¹ãƒˆ */
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        /* çµæœè¡¨ç¤º */
        .results-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .results-item {
            background-color: #F0F9FF; /* è–„ã„é’ã®èƒŒæ™¯ */
            border: 1px solid #BFDBFE;
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.1rem;
            font-weight: 500;
        }
        .results-item .rank {
            font-weight: 700;
            color: #6D28D9;
            margin-right: 15px;
            min-width: 30px;
            text-align: right;
        }
        .results-item .song-name {
            flex-grow: 1;
        }
        .results-item .score {
            font-weight: 700;
            color: #10B981; /* ç·‘è‰² */
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®èª¿æ•´ */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            h2 {
                font-size: 1.5rem;
            }
            .countdown-timer {
                font-size: 1.8rem;
            }
            .action-button {
                padding: 12px 25px;
                font-size: 1rem;
            }
            .container {
                padding: 25px;
                margin: 10px;
            }
            .song-item {
                font-size: 0.9rem;
            }
            .drag-drop-item {
                padding: 10px 12px;
                font-size: 0.95rem;
            }
            .results-item {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="topPage" class="page-section active">
            <header>
                <h1>é¢¨æ­Œç•ªä»˜ äºˆæƒ³ã‚µã‚¤ãƒˆ</h1>
                <h2>é¢¨ç”·å¡¾ã€Œé¢¨æ­Œç•ªä»˜ã€é¢¨ç‹(ãƒ•ã‚¡ãƒ³)å‹æ‰‹ã«äºˆæƒ³</h2>
            </header>

            <main>
                <p>
                    é¢¨ç”·å¡¾ã®æœ€æ–°ã‚¢ãƒ«ãƒãƒ ã€Œé¢¨æ­Œç•ªä»˜ã€ã«ã¡ãªã‚“ã§ã€é¢¨ç‹(ãƒ•ã‚¡ãƒ³)ã®çš†ã•ã‚“ä¸Šä½5æ›²ã‚’å‹æ‰‹ã«äºˆæƒ³ã™ã‚‹ã‚µã‚¤ãƒˆã§ã™ã€‚
                    ãƒ©ã‚¤ãƒ–é–‹å‚¬æ—¥ã¾ã§ã®ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’è¦‹ãªãŒã‚‰ã€ã”è‡ªèº«ã®æƒ³ã„ã‚’è¾¼ã‚ã¦äºˆæƒ³ã‚’æŠ•ç¨¿ã—ã¾ã—ã‚‡ã†ï¼
                </p>
                <p>
                    å…¬å¼æƒ…å ±ã¯ã“ã¡ã‚‰ï¼š
                    <a href="https://m.nfs724.com/?" target="_blank" rel="noopener noreferrer">é¢¨ç”·å¡¾å…¬å¼ã‚µã‚¤ãƒˆ</a>
                    <a href="https://timetreeapp.com/public_calendars/924_fdj/events/2580281947701440066?monthly=2025-08-01"target="_blank" rel="noopener noreferrer"></a>
                </p>
                <p class="text-sm text-red-600 font-semibold mt-4">
                    â€»ã“ã®ã‚µã‚¤ãƒˆã¯ãƒ•ã‚¡ãƒ³ãŒç‹¬è‡ªã«ä½œæˆã—ãŸéå…¬å¼ã®ã‚µã‚¤ãƒˆã§ã™ã€‚é¢¨ç”·å¡¾å…¬å¼æ§˜ã¨ã¯ãªã«ã®é–¢ä¿‚ã‚‚ã”ã–ã„ã¾ã›ã‚“ã€‚
                </p>
                
                <div class="countdown-timer" id="countdown">
                    ãƒ©ã‚¤ãƒ–ã¾ã§ã‚ã¨ XXæ—¥ XXæ™‚é–“ XXåˆ† XXç§’
                </div>

                <div class="action-area">
                    <button id="predictButton" class="action-button" disabled>äºˆæƒ³ã™ã‚‹</button>
                    <span id="predictionClosedMessage" class="hidden text-gray-600 text-lg">æŠ•ç¥¨å—ä»˜çµ‚äº†</span>
                    <button id="viewResultsButton" class="action-button hidden">çµæœã‚’è¦‹ã‚‹</button>
                </div>
            </main>
        </div>

        <!-- äºˆæƒ³æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="predictionPage" class="page-section">
            <h2 class="text-2xl font-bold mb-6 text-center text-purple-700">ã‚ãªãŸã®TOP5ã‚’äºˆæƒ³ã—ã‚ˆã†ï¼</h2>

            <div class="mb-4 text-center text-gray-700">
                <p>ä¸‹ã®ãƒªã‚¹ãƒˆã‹ã‚‰**ä¸Šä½5æ›²**ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                <p>é¸æŠå¾Œã€å³ã®ã‚¨ãƒªã‚¢ã§ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§é †ä½ã‚’å…¥ã‚Œæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- æ¥½æ›²é¸æŠãƒªã‚¹ãƒˆ -->
                <div>
                    <h3 class="text-xl font-semibold mb-3 text-gray-800">å…¨æ¥½æ›²ãƒªã‚¹ãƒˆ (<span id="selectedCount">0</span>/5 é¸æŠä¸­)</h3>
                    <!-- æ¤œç´¢ãƒãƒ¼ã®è¿½åŠ  -->
                    <input type="text" id="songSearchInput" placeholder="æ¥½æ›²åã‚’æ¤œç´¢..." class="w-full p-2 mb-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                    <div class="song-list-container">
                        <ul id="allSongsList">
                            <!-- æ¥½æ›²ãƒªã‚¹ãƒˆã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
                        </ul>
                    </div>
                </div>

                <!-- ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã‚¨ãƒªã‚¢ -->
                <div>
                    <h3 class="text-xl font-semibold mb-3 text-gray-800">ã‚ãªãŸã®TOP5äºˆæƒ³</h3>
                    <div class="drag-drop-list" id="selectedSongsList">
                        <p class="text-gray-500 text-center mt-10">ã“ã“ã«5æ›²ãŒé¸æŠã•ã‚Œã‚‹ã¨ã€ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§é †ä½ã‚’å…¥ã‚Œæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚</p>
                    </div>
                </div>
            </div>

            <div class="action-area mt-8">
                <button id="submitPredictionButton" class="action-button w-full md:w-auto px-10 py-4 text-xl" disabled>Xã«æŠ•ç¨¿ã™ã‚‹</button>
            </div>

            <!-- æŠ•ç¨¿å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (åˆæœŸã¯éè¡¨ç¤º) -->
            <div id="predictionConfirmation" class="confirmation-message hidden mt-8">
                <p>ğŸ‰ äºˆæƒ³ãŒå®Œäº†ã—ã¾ã—ãŸï¼X(æ—§Twitter)ã«æŠ•ç¨¿ã•ã‚Œã¾ã—ãŸï¼ã”å‚åŠ ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼</p>
                <!-- shareOnXButton ã¯ submitPredictionButton ã«çµ±åˆã•ã‚ŒãŸãŸã‚å‰Šé™¤ -->
            </div>

            <button id="backToTopFromPredict" class="action-button bg-gray-500 hover:bg-gray-600 mt-8">ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</button>
        </div>

        <!-- çµæœãƒšãƒ¼ã‚¸ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div id="resultsPage" class="page-section">
            <h2 class="text-2xl font-bold mb-6 text-center text-purple-700">ãƒ•ã‚¡ãƒ³å…¨ä½“ã®é›†è¨ˆçµæœ</h2>

            <div id="overallRanking" class="mb-8">
                <h3 class="text-xl font-semibold mb-3 text-gray-800">TOP5ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3>
                <ul class="results-list">
                    <!-- çµæœã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
                    <li class="results-item"><span class="rank">1ä½</span> <span class="song-name">æ›²åA</span> <span class="score">ã‚¹ã‚³ã‚¢: 100</span></li>
                    <li class="results-item"><span class="rank">2ä½</span> <span class="song-name">æ›²åB</span> <span class="score">ã‚¹ã‚³ã‚¢: 95</span></li>
                    <li class="results-item"><span class="rank">3ä½</span> <span class="song-name">æ›²åC</span> <span class="score">ã‚¹ã‚³ã‚¢: 90</span></li>
                    <!-- ä»¥ä¸‹ã€åŒæ§˜ã«5ä½ã¾ã§ -->
                </ul>
            </div>

            <div id="yourPredictionResults" class="mb-8 hidden">
                <h3 class="text-xl font-semibold mb-3 text-gray-800">ã‚ãªãŸã®äºˆæƒ³ã¨æ­£è§£åº¦</h3>
                <p id="yourPredictionText" class="mb-4 text-gray-700">ã‚ãªãŸã®äºˆæƒ³: 1ä½: æ›²A, 2ä½: æ›²B, ...</p>
                <p id="accuracyScore" class="text-2xl font-bold text-green-600">æ­£è§£åº¦: XX%</p>
                <button id="shareYourResultsOnXButton" class="action-button bg-blue-500 hover:bg-blue-600 mt-4">
                    ã‚ãªãŸã®çµæœã‚’X(æ—§Twitter)ã«ã‚·ã‚§ã‚¢ã™ã‚‹
                </button>
            </div>

            <button id="backToTopFromResults" class="action-button bg-gray-500 hover:bg-gray-600 mt-8">ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹</button>
        </div>

        <footer class="footer">
            <p>&copy; 2025 é¢¨æ­Œç•ªä»˜ é¢¨ç‹(ãƒ•ã‚¡ãƒ³)å‹æ‰‹ã«äºˆæƒ³ã‚µã‚¤ãƒˆ.</p>
            <p>
                <a href="https://m.nfs724.com/?" target="_blank" rel="noopener noreferrer">é¢¨ç”·å¡¾å…¬å¼ã‚µã‚¤ãƒˆ</a>
            </p>
        </footer>
    </div>

    <script>
        // ãƒ©ã‚¤ãƒ–é–‹å‚¬æ—¥æ™‚ã‚’è¨­å®š (æ—¥æœ¬æ™‚é–“: 2025å¹´8æœˆ9æ—¥ 13æ™‚00åˆ†00ç§’)
        const liveDate = new Date('2025-08-09T13:00:00+09:00');
        // äºˆæƒ³æŠ•ç¨¿ç· ã‚åˆ‡ã‚Šæ—¥æ™‚ (ãƒ©ã‚¤ãƒ–é–‹å‚¬ã®1æ™‚é–“å‰ã¨ä»®å®š)
        const predictionEndDate = new Date(liveDate.getTime() - (60 * 60 * 1000)); // ãƒ©ã‚¤ãƒ–ã®1æ™‚é–“å‰

        // DOMè¦ç´ ã®å–å¾—
        const topPage = document.getElementById('topPage');
        const predictionPage = document.getElementById('predictionPage');
        const resultsPage = document.getElementById('resultsPage');

        const countdownElement = document.getElementById('countdown');
        const predictButton = document.getElementById('predictButton');
        const predictionClosedMessage = document.getElementById('predictionClosedMessage');
        const viewResultsButton = document.getElementById('viewResultsButton');

        const allSongsListElement = document.getElementById('allSongsList');
        const songSearchInput = document.getElementById('songSearchInput'); // æ¤œç´¢å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
        const selectedSongsListElement = document.getElementById('selectedSongsList');
        const selectedCountElement = document.getElementById('selectedCount');
        const submitPredictionButton = document.getElementById('submitPredictionButton');
        const predictionConfirmation = document.getElementById('predictionConfirmation');
        // const shareOnXButton = document.getElementById('shareOnXButton'); // å‰Šé™¤ã•ã‚ŒãŸãŸã‚ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ

        const overallRankingElement = document.getElementById('overallRanking');
        const yourPredictionResultsElement = document.getElementById('yourPredictionResults');
        const yourPredictionTextElement = document.getElementById('yourPredictionText');
        const accuracyScoreElement = document.getElementById('accuracyScore');
        const shareYourResultsOnXButton = document.getElementById('shareYourResultsOnXButton');

        const backToTopFromPredictButton = document.getElementById('backToTopFromPredict');
        const backToTopFromResultsButton = document.getElementById('backToTopFromResults');

        // é¢¨ç”·å¡¾ã®å…¨æ¥½æ›²ãƒªã‚¹ãƒˆ
        const allSongs = [
            { id: 'song1', name: 'ç”·å‚' }, { id: 'song2', name: '17\'sâ˜†STAR' }, { id: 'song3', name: 'ä¿ºã®ç©º' },
            { id: 'song4', name: 'ãƒ¤ãƒƒã‚¿ãƒ¼ãƒãƒ³ã®æ­Œ' }, { id: 'song5', name: 'ã„ã„ç”·' }, { id: 'song6', name: 'å‹ã¤ã‚“ã ï¼' },
            { id: 'song7', name: 'ã‚­ãƒŸã®ã‚‚ã®ãŒãŸã‚Š' }, { id: 'song8', name: 'å“€æˆ¦æ­Œ' }, { id: 'song9', name: 'å¤©æ‰ãƒã‚«ãƒœãƒ³' },
            { id: 'song10', name: 'ãƒ²ã‚¿ã‚­ã‚¹ãƒˆ' }, { id: 'song11', name: 'ãƒ¤ãƒƒã‚¿ãƒ¼ãƒãƒ³ã®æ­Œï¼ˆKorean ver.ï¼‰' }, { id: 'song12', name: 'ç‡ƒãˆã¦ãƒ’ãƒ¼ãƒ­ãƒ¼' },
            { id: 'song13', name: 'çµ†' }, { id: 'song14', name: 'ä¸­é‡è…ç”·å­å­¦åœ’æ ¡æ­Œ' }, { id: 'song15', name: 'ç„¡æ•µï¼å¤ä¼‘ã¿' },
            { id: 'song16', name: 'ã‚¢ãƒ©ãƒ©ã®å‘ªæ–‡' }, { id: 'song17', name: 'è‰é£Ÿãƒ©ã‚¤ã‚ªãƒ³' }, { id: 'song18', name: 'åŒã˜æ™‚ä»£ã«ç”Ÿã¾ã‚ŒãŸè‹¥è€…ãŸã¡' },
            { id: 'song19', name: 'æª„ï¼å¸å›½è¯æ’ƒå›£ï¼ˆæ”¹ï¼‰ï½è…ç”·å¡¾Ver.ï½' }, { id: 'song20', name: 'Rusty Sword' }, { id: 'song21', name: 'BOY\'S LOVEï½æ‹³ã®ãƒãƒ¼ãƒ¢ãƒ‹ãƒ¼ç·¨ï½' },
            { id: 'song22', name: 'ãã¾ãã‚Œã®ã‚„ã‚‹æ°—' }, { id: 'song23', name: 'Love Spider' }, { id: 'song24', name: 'é¢¨ã«ã®ã£ã¦' },
            { id: 'song25', name: 'é¢¨ä¸€æ†' }, { id: 'song26', name: 'my home town' }, { id: 'song27', name: 'å¤¢å¹»ã®ãƒ—ãƒ­ã‚­ã‚ªãƒ³' },
            { id: 'song28', name: 'é›¨ã¨ãã©ãæ™´ã‚Œã®ã¡è™¹' }, { id: 'song29', name: 'ã›ãƒ¼ã®ã§ãƒ‰ãƒ³ãƒã‚¤ï¼' }, { id: 'song30', name: 'å‹‡æ°—ã®FLAG' },
            { id: 'song31', name: 'é‡è‰¯çŒ«ãƒãƒªã‚¢' }, { id: 'song32', name: 'MOVE' }, { id: 'song33', name: 'é£›ã³ç«‹ã¦ï¼ãƒ•ã‚¥ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼' },
            { id: 'song34', name: 'æ£šç”°ç±³' }, { id: 'song35', name: 'ä¿¡ã˜ã¦ã‚†ã‘' }, { id: 'song36', name: 'äººç”Ÿã‚ã¯ã¯ã£ï¼' },
            { id: 'song37', name: 'é›ªã®å¤œ' }, { id: 'song38', name: 'ã‚»ãƒ³ãƒ‘ã‚¤ã®å½¼å¥³' }, { id: 'song39', name: 'ä¸‹ã‚’å‘ã„ã¦å¸°ã‚ã†' },
            { id: 'song40', name: 'RIKISHI-MAN' }, { id: 'song41', name: 'ã˜ã‚ƒã‚ã­' }, { id: 'song42', name: 'ç”·è£…ãƒ¬ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³' },
            { id: 'song43', name: 'ã‚«ã‚¯ãƒ†ãƒ«ãƒ»ã‚ªãƒ³ãƒ»ã‚¶ãƒ»ãƒ“ãƒ¼ãƒ' }, { id: 'song44', name: 'å¤§èˆªæµ·ãƒœãƒ¼ã‚¤' }, { id: 'song45', name: 'ãƒã‚§ãƒ³ãƒ¡ãƒ³å¤©å›½' },
            { id: 'song46', name: 'å¤ªé™½ã¿ãŸã„ãªã‚­ãƒŸãŒå¥½ã' }, { id: 'song47', name: 'å‚·ã ã‚‰ã‘ã®ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ï¼ˆé¢¨ç”·å¡¾ver.ï¼‰' }, { id: 'song48', name: 'EYE OF THE TYPHOON' },
            { id: 'song49', name: 'Sensation' }, { id: 'song50', name: 'ç´™ãƒ’ã‚³ãƒ¼ã‚­' }, { id: 'song51', name: 'ã‚«ãƒ©ãƒ•ãƒ«ãƒ—ãƒ©ãƒ³ã‚¿ãƒ³' },
            { id: 'song52', name: 'åƒ•ã‚‰ã®æ­©ãé“' }, { id: 'song53', name: 'Galileo ï½ãƒ—ãƒ­ã‚­ã‚ªãƒ³ã‚’è¶Šãˆã¦ï½' }, { id: 'song54', name: 'BE HERO' },
            { id: 'song55', name: 'ä¸ƒè‰²ã®é³¥' }, { id: 'song56', name: 'ã‚¸ãƒ¥ã‚¯ã‚¦ã‚©ãƒ¼ã‚«ãƒ¼' }, { id: 'song57', name: 'ç¬é–“åˆ°æ¥ãƒ•ãƒ¥ãƒ¼ãƒãƒ£ãƒ¼' },
            { id: 'song58', name: 'æ¡œã®YELL' }, { id: 'song59', name: 'ã‚µãƒã‚¤ãƒ©ãƒ–ã‚²ãƒ¼ãƒ ' }, { id: 'song60', name: 'ã‚‚ã—ã‚‚ ã“ã‚ŒãŒæ‹ãªã‚‰' },
            { id: 'song61', name: 'SAMURAI' }, { id: 'song62', name: 'ã‹ã–ã¿ã©ã‚Š' }, { id: 'song63', name: 'å‹é”ã¨å‘¼ã¹ã‚‹å›ã¸' },
            { id: 'song64', name: 'OH! ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‡ã‚¤' }, { id: 'song65', name: 'ãƒ©ãƒ–ãƒ¡ãƒƒã‚»ãƒ³ã‚¸ãƒ£ãƒ¼' }, { id: 'song66', name: 'STARTING STAR!' },
            { id: 'song67', name: 'Fighting Man' }, { id: 'song68', name: 'This is Love' }, { id: 'song69', name: 'NOIRï½ãƒãƒ¯ãƒ¼ãƒ«ï½' },
            { id: 'song70', name: 'With You' }, { id: 'song71', name: 'ãƒ­ãƒ³ãƒªãƒ¼ ã‚ªãƒ³ãƒªãƒ¼ ãƒãƒ¼ãƒˆ' }, { id: 'song72', name: 'è¨¼ï¼soul mateï¼' },
            { id: 'song73', name: 'ã‚¤ãƒã‚»ãƒ³ãƒˆãƒ»ãƒ©ãƒãƒ¼' }, { id: 'song74', name: 'æ˜Ÿå±‘ã®é›«' }, { id: 'song75', name: 'å¸Œæœ›ã®å¤•é™½ãŒç‡ƒãˆã¦ã„ã‚‹' },
            { id: 'song76', name: 'æ–°ãŸãªã‚‹å¹•é–‹ã‘ã®ãŸã‚ã®å¹•é–‹ã‘ã«ã‚ˆã‚‹ç‹‚è©©æ›²ï½ã‚­ãƒŸãŒã„ã‚Œã°ã‚ªãƒ¬ãŸã¡ã‚‚ç¬‘é¡”âˆï¼ˆç„¡é™å¤§ï¼‰ï½' }, { id: 'song77', name: 'ã‚­ãƒ©ãƒƒã¨Lâ˜†VE' }, { id: 'song78', name: 'ã—ã‚ã‚ã›ã¨ã‚“ã¼' },
            { id: 'song79', name: 'å›è‰²ã€…ç§»ã‚Š' }, { id: 'song80', name: 'Welcome to my familia' }, { id: 'song81', name: 'Milky Wayï½ã„ã¾ã€ã‚ã„ã«ã‚†ãã‚ˆï½' },
            { id: 'song82', name: 'æœ€é«˜ã‚·ãƒ£ã‚¦ãƒˆ!' }, { id: 'song83', name: 'Tãƒ»Oãƒ»T!ï½Vivid Menï½' }, { id: 'song84', name: 'ãƒ”ãƒ¼ã‚¹ã‚µã‚¤ãƒ³ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°' },
            { id: 'song85', name: 'ãƒ¦ãƒ¬ãƒ­' }, { id: 'song86', name: 'Caramel Popcorn' }, { id: 'song87', name: 'ãŠé¡˜ã„ãƒˆãƒ ãƒ†ï½è–ãªã‚‹å¤œã«ï½' },
            { id: 'song88', name: 'ãƒ„ãƒãƒ¡' }, { id: 'song89', name: 'Ballad of the Phantom' }, { id: 'song90', name: '@Daylight' },
            { id: 'song91', name: 'Dash&Daaash!!' }, { id: 'song92', name: 'Excuse You!' }, { id: 'song93', name: 'å¤¢ã®åº§æ¨™' },
            { id: 'song94', name: 'sunny' }, { id: 'song95', name: 'æ³¢ã‚®ãƒ¥ã£ï¼' }, { id: 'song96', name: 'Unchain Boys' },
            { id: 'song97', name: 'ãƒŸãƒ¥ãƒ¼ã‚¸ãƒƒã‚¯' }, { id: 'song98', name: 'No one\'s gonna stop us now' }, { id: 'song99', name: 'ã‚³ã‚³ã‚¢ãƒ»ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­ãƒ»ã¹ã‚¤ãƒ“ãƒ¼' },
            { id: 'song100', name: 'ç¬‘ã†é–€ã«æ˜æ—¥ã¯æ¥ã‚‹' }, { id: 'song101', name: 'Diamond Heart' }, { id: 'song102', name: 'DDD' },
            { id: 'song103', name: 'ä¼šã„ãŸã„ã€ä¼šã„ãŸã„' }, { id: 'song104', name: 'ãƒ†ãƒãƒŠãƒ«ãƒ›ã‚¦ãƒ˜' }, { id: 'song105', name: 'Your Eyes Only' },
            { id: 'song106', name: 'é’æ˜¥' }, { id: 'song107', name: 'å»»ã‚Œé¢¨ãã‚‹ã¾' }, { id: 'song108', name: 'Bye-bye Pain' },
            { id: 'song109', name: 'å¿˜ã‚Œé›ª' }, { id: 'song110', name: 'LIKE A RAINBOW' }, { id: 'song111', name: 'å›é€†è€…ãŸã¡ã«æ˜æ—¥ã‚ˆã‚ã‚Œ' },
            { id: 'song112', name: 'OPEN SESAME' }, { id: 'song113', name: 'ç”Ÿãã‚‹ã“ã¨ã¯å°Šã„ã«æ±ºã¾ã£ã¦ã‚“ã ã‚' }, { id: 'song114', name: 'WE ARE LIGHT SAVERS' },
            { id: 'song115', name: 'Best Wishes' }, { id: 'song116', name: 'BLESS' }, { id: 'song117', name: 'ãƒãƒªãƒ¼ãƒ»ãƒ¦ãƒ¼ï¼' },
            { id: 'song118', name: 'ãƒãƒ”ã‚¹ã‚¯' }, { id: 'song119', name: 'Hello Hello' }, { id: 'song120', name: 'Tender Rain' },
            { id: 'song121', name: 'SHINY SHINY' }, { id: 'song122', name: 'ä¸ƒå¸¸ã®é¢¨å™¨' }, { id: 'song123', name: 'Baby U' },
            { id: 'song124', name: 'å‹ã¤ã‚“ã ï¼(Punk Ver.)' }, { id: 'song125', name: 'Jellyfish' }, { id: 'song126', name: 'å›æ—¥å’Œ' },
            { id: 'song127', name: 'ã‚¬ãƒ³ãƒãƒ¼ãƒ¬ï¼' }, { id: 'song128', name: 'The Sky' }, { id: 'song129', name: 'å›ã¨ãªã‚‰ã°ã€åƒ•ã‚‰ãªã‚‰ã°' },
            { id: 'song130', name: 'ã‚¬ãƒ ã‚·ãƒ£ãƒ©ãƒ€ãƒƒã‚·ãƒ¥ï¼' }, { id: 'song131', name: 'My Radio Star' }, { id: 'song132', name: 'ãƒãƒ³ãƒœã‚¦' },
            { id: 'song133', name: 'å¤±æ‹ã‚¸ã‚§ãƒ©ãƒ†ãƒªã‚¢' }, { id: 'song134', name: 'ãƒ“ãƒ¼ã‚¹ãƒˆãƒ­ãƒªãƒãƒƒãƒ—' }, { id: 'song135', name: 'little-big-love' },
            { id: 'song136', name: 'My own funk session' }, { id: 'song137', name: 'ä¸€ç”Ÿé’æ˜¥ã€ä¸€ç·’ã«é’æ˜¥' }, { id: 'song138', name: 'FOCUSï¼' },
            { id: 'song139', name: 'Sing for you' }, { id: 'song140', name: 'ã‚¤ãƒƒã‚µã‚¤ã‚¬ãƒƒã‚µã‚¤I LOVE YOU' }, { id: 'song141', name: 'ãƒ„ãƒŠã‚¬ãƒ«ã‚¹ã‚­ãƒ' },
            { id: 'song142', name: 'ãŠã‚„ã™ã¿ãƒ•ãƒ­ãƒ¼ãƒˆ' }, { id: 'song143', name: 'exdreamers' }, { id: 'song144', name: 'å¯’æ³¢è¥²æ¥' },
            { id: 'song145', name: 'A new chapter' }, { id: 'song146', name: 'To Future Me' }, { id: 'song147', name: 'Flower' },
            { id: 'song148', name: 'Fun Fan Fun' }
        ];

        let selectedSongs = []; // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé¸æŠã—ãŸ5æ›²ã®é…åˆ—

        // ãƒšãƒ¼ã‚¸è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
        function showPage(pageId) {
            const pages = [topPage, predictionPage, resultsPage];
            pages.forEach(page => {
                if (page.id === pageId) {
                    page.classList.add('active');
                } else {
                    page.classList.remove('active');
                }
            });
        }

        // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒãƒ¼ã®æ›´æ–°
        function updateCountdown() {
            const now = new Date().getTime();
            const distanceToLive = liveDate.getTime() - now;
            const distanceToPredictionEnd = predictionEndDate.getTime() - now;

            // ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤ºã®æ›´æ–°
            if (distanceToLive > 0) {
                const days = Math.floor(distanceToLive / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distanceToLive % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distanceToLive % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distanceToLive % (1000 * 60)) / 1000);
                countdownElement.innerHTML = `ãƒ©ã‚¤ãƒ–ã¾ã§ã‚ã¨ ${days}æ—¥ ${hours}æ™‚é–“ ${minutes}åˆ† ${seconds}ç§’`;
            } else {
                countdownElement.innerHTML = 'ãƒ©ã‚¤ãƒ–é–‹å‚¬ä¸­ï¼';
            }

            // äºˆæƒ³æŠ•ç¨¿ãƒœã‚¿ãƒ³ã®åˆ¶å¾¡
            if (distanceToPredictionEnd > 0) {
                // äºˆæƒ³æŠ•ç¨¿æœŸé–“ä¸­
                predictButton.disabled = false;
                predictButton.textContent = 'äºˆæƒ³ã™ã‚‹';
                predictButton.classList.remove('hidden');
                predictionClosedMessage.classList.add('hidden');
                viewResultsButton.classList.add('hidden');
            } else {
                // äºˆæƒ³æŠ•ç¨¿æœŸé–“çµ‚äº†å¾Œ
                predictButton.disabled = true;
                predictButton.classList.add('hidden');
                predictionClosedMessage.classList.remove('hidden');
                // ãƒ©ã‚¤ãƒ–é–‹å‚¬æ™‚åˆ»ã‚’éããŸã‚‰ã€Œçµæœã‚’è¦‹ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
                if (now >= liveDate.getTime()) {
                    viewResultsButton.classList.remove('hidden');
                    viewResultsButton.textContent = 'çµæœã‚’è¦‹ã‚‹';
                }
            }
        }

        // å…¨æ¥½æ›²ãƒªã‚¹ãƒˆã®è¡¨ç¤ºã¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š (æ¤œç´¢æ©Ÿèƒ½ä»˜ã)
        function renderAllSongs(searchQuery = '') {
            allSongsListElement.innerHTML = ''; // ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
            const filteredSongs = allSongs.filter(song =>
                song.name.toLowerCase().includes(searchQuery.toLowerCase())
            );

            filteredSongs.forEach(song => {
                const li = document.createElement('li');
                li.className = 'song-item';
                // æ—¢ã«é¸æŠã•ã‚Œã¦ã„ã‚‹æ›²ã¯ãƒã‚§ãƒƒã‚¯æ¸ˆã¿ã¨ã—ã¦è¡¨ç¤º
                const isSelected = selectedSongs.some(s => s.id === song.id);
                li.innerHTML = `
                    <input type="checkbox" id="song-${song.id}" value="${song.id}" data-song-name="${song.name}" class="form-checkbox h-5 w-5 text-purple-600 rounded" ${isSelected ? 'checked' : ''}>
                    <label for="song-${song.id}" class="ml-2 text-gray-700 cursor-pointer">${song.name}</label>
                `;
                allSongsListElement.appendChild(li);

                const checkbox = li.querySelector('input[type="checkbox"]');
                checkbox.addEventListener('change', (event) => {
                    if (event.target.checked) {
                        if (selectedSongs.length < 5) { // 10æ›²ã‹ã‚‰5æ›²ã«å¤‰æ›´
                            selectedSongs.push({ id: song.id, name: song.name });
                        } else {
                            event.target.checked = false; // 5æ›²ä»¥ä¸Šé¸æŠã§ããªã„ã‚ˆã†ã«ã™ã‚‹
                            alert('é¸æŠã§ãã‚‹æ¥½æ›²ã¯5æ›²ã¾ã§ã§ã™ã€‚'); // ã‚¢ãƒ©ãƒ¼ãƒˆã‚‚5æ›²ã«
                        }
                    } else {
                        selectedSongs = selectedSongs.filter(s => s.id !== song.id);
                    }
                    updateSelectedSongsList();
                });
            });
        }

        // é¸æŠã•ã‚ŒãŸæ¥½æ›²ãƒªã‚¹ãƒˆï¼ˆãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã‚¨ãƒªã‚¢ï¼‰ã®æ›´æ–°
        function updateSelectedSongsList() {
            selectedSongsListElement.innerHTML = '';
            selectedCountElement.textContent = selectedSongs.length;

            if (selectedSongs.length === 0) {
                selectedSongsListElement.innerHTML = '<p class="text-gray-500 text-center mt-10">ã“ã“ã«5æ›²ãŒé¸æŠã•ã‚Œã‚‹ã¨ã€ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§é †ä½ã‚’å…¥ã‚Œæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚</p>'; // èª¬æ˜æ–‡ã‚‚5æ›²ã«
                submitPredictionButton.disabled = true;
                return;
            }

            selectedSongs.forEach((song, index) => {
                const li = document.createElement('li');
                li.className = 'drag-drop-item';
                li.setAttribute('data-id', song.id);
                li.innerHTML = `<span class="rank">${index + 1}ä½</span> ${song.name}`;
                selectedSongsListElement.appendChild(li);
            });

            // 5æ›²é¸æŠã•ã‚ŒãŸã‚‰æŠ•ç¨¿ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            submitPredictionButton.disabled = selectedSongs.length !== 5; // 10æ›²ã‹ã‚‰5æ›²ã«å¤‰æ›´
        }

        // Sortable.jsã®åˆæœŸåŒ–
        let sortable;
        function initSortable() {
            if (sortable) {
                sortable.destroy(); // æ—¢å­˜ã®Sortableã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç ´æ£„
            }
            sortable = Sortable.create(selectedSongsListElement, {
                animation: 150,
                ghostClass: 'sortable-ghost',
                chosenClass: 'sortable-chosen',
                onEnd: function (evt) {
                    // ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—å¾Œã®é †ä½ã‚’æ›´æ–°
                    const newOrder = Array.from(evt.from.children).map(item => {
                        const songId = item.getAttribute('data-id');
                        return selectedSongs.find(s => s.id === songId);
                    });
                    selectedSongs = newOrder.filter(Boolean); // null/undefinedã‚’é™¤å¤–
                    updateSelectedSongsList(); // é †ä½è¡¨ç¤ºã‚’æ›´æ–°
                }
            });
        }

        // äºˆæƒ³æŠ•ç¨¿å‡¦ç† (Xã«æŠ•ç¨¿ã™ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ãƒãƒ³ãƒ‰ãƒ©)
        async function submitPredictionAndShareOnX() {
            if (selectedSongs.length !== 5) { // 5æ›²é¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
                alert('5æ›²ã™ã¹ã¦ã‚’é¸æŠã—ã¦é †ä½ã‚’æ±ºå®šã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®äºˆæƒ³å†…å®¹ã‚’ã‚·ã‚§ã‚¢ç”¨ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
            const predictionData = selectedSongs.map((song, index) => ({
                songId: song.id,
                rank: index + 1
            }));
            localStorage.setItem('lastPrediction', JSON.stringify(predictionData));

            // Xã¸ã®ã‚·ã‚§ã‚¢ã‚’å®Ÿè¡Œ
            sharePredictionOnX();

            // æˆåŠŸæ™‚ã®UIè¡¨ç¤º
            submitPredictionButton.classList.add('hidden');
            predictionConfirmation.classList.remove('hidden');
        }

        // Xï¼ˆæ—§Twitterï¼‰ã‚·ã‚§ã‚¢æ©Ÿèƒ½
        function sharePredictionOnX() {
            const lastPrediction = JSON.parse(localStorage.getItem('lastPrediction'));
            if (!lastPrediction || lastPrediction.length === 0) {
                alert('ã‚·ã‚§ã‚¢ã™ã‚‹äºˆæƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
                return;
            }

            let tweetText = 'ç§ã®é¢¨æ­Œç•ªä»˜TOP5äºˆæƒ³ï¼\n'; // TOP10ã‹ã‚‰TOP5ã«å¤‰æ›´
            lastPrediction.forEach((item, index) => {
                const song = allSongs.find(s => s.id === item.songId);
                if (song) {
                    tweetText += `${index + 1}ä½: ${song.name}\n`;
                }
            });
            tweetText += '\n#é¢¨æ­Œç•ªä»˜å‹æ‰‹ã«äºˆæƒ³ #é¢¨ç”·å¡¾'; // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’ä¿®æ­£
            const siteUrl = window.location.href; // ç¾åœ¨ã®ã‚µã‚¤ãƒˆURL
            const tweetUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}&url=${encodeURIComponent(siteUrl)}`;
            window.open(tweetUrl, '_blank');
        }

        // çµæœãƒšãƒ¼ã‚¸ã®è¡¨ç¤º (ä»®ãƒ‡ãƒ¼ã‚¿)
        function renderResults() {
            const overallRankingListElement = overallRankingElement.querySelector('ul');
            overallRankingListElement.innerHTML = ''; // ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢

            // ä»®ã®é›†è¨ˆçµæœãƒ‡ãƒ¼ã‚¿ (TOP5ã«ä¿®æ­£)
            const mockOverallResults = [
                { id: 'song6', name: 'å‹ã¤ã‚“ã ï¼', score: 120, rank: 1 },
                { id: 'song25', name: 'é¢¨ä¸€æ†', score: 115, rank: 2 },
                { id: 'song18', name: 'åŒã˜æ™‚ä»£ã«ç”Ÿã¾ã‚ŒãŸè‹¥è€…ãŸã¡', score: 110, rank: 3 },
                { id: 'song42', name: 'ç”·è£…ãƒ¬ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³', score: 105, rank: 4 },
                { id: 'song1', name: 'ç”·å‚', score: 100, rank: 5 },
            ];

            mockOverallResults.forEach(result => {
                const li = document.createElement('li');
                li.className = 'results-item';
                li.innerHTML = `<span class="rank">${result.rank}ä½</span> <span class="song-name">${result.name}</span> <span class="score">ã‚¹ã‚³ã‚¢: ${result.score}</span>`;
                overallRankingListElement.appendChild(li);
            });

            // ãƒ¦ãƒ¼ã‚¶ãƒ¼è‡ªèº«ã®äºˆæƒ³ã¨æ­£è§£åº¦ã®è¡¨ç¤º (ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã•ã‚ŒãŸäºˆæƒ³ãŒã‚ã‚Œã°)
            const lastPrediction = JSON.parse(localStorage.getItem('lastPrediction'));
            if (lastPrediction && lastPrediction.length === 5) { // 5æ›²ã«å¤‰æ›´
                yourPredictionResultsElement.classList.remove('hidden');
                let yourPredictionString = 'ã‚ãªãŸã®äºˆæƒ³: ';
                lastPrediction.forEach((item, index) => {
                    const song = allSongs.find(s => s.id === item.songId);
                    if (song) {
                        yourPredictionString += `${index + 1}ä½: ${song.name}${index < 4 ? ', ' : ''}`; // ã‚«ãƒ³ãƒã®æ•°ã‚’èª¿æ•´
                    }
                });
                yourPredictionTextElement.textContent = yourPredictionString;

                // æ­£è§£åº¦ãƒ­ã‚¸ãƒƒã‚¯ (ç°¡æ˜“ç‰ˆ: é †ä½ãŒä¸€è‡´ã—ãŸæ•°ã§è¨ˆç®—)
                let correctCount = 0;
                lastPrediction.forEach((userItem, userIndex) => {
                    const overallRankedItem = mockOverallResults.find(r => r.id === userItem.songId);
                    if (overallRankedItem && overallRankedItem.rank === (userIndex + 1)) {
                        correctCount++;
                    }
                });
                const accuracy = (correctCount / 5) * 100; // 5ã«å¤‰æ›´
                accuracyScoreElement.textContent = `æ­£è§£åº¦: ${accuracy.toFixed(1)}%`;

            } else {
                yourPredictionResultsElement.classList.add('hidden');
            }
        }

        // Xï¼ˆæ—§Twitterï¼‰ã‚·ã‚§ã‚¢æ©Ÿèƒ½ (çµæœãƒšãƒ¼ã‚¸ç”¨)
        function shareResultsOnX() {
            const accuracyText = accuracyScoreElement.textContent;
            const yourPredictionText = yourPredictionTextElement.textContent;
            let tweetText = `é¢¨æ­Œç•ªä»˜ãƒ•ã‚¡ãƒ³äºˆæƒ³ã®çµæœãŒå‡ºã¾ã—ãŸï¼\n${accuracyText}\n\n${yourPredictionText}\n\n#é¢¨æ­Œç•ªä»˜å‹æ‰‹ã«äºˆæƒ³ #é¢¨ç”·å¡¾`; // ãƒãƒƒã‚·ãƒ¥ã‚¿ã‚°ã‚’ä¿®æ­£
            const siteUrl = window.location.href;
            const tweetUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(tweetText)}&url=${encodeURIComponent(siteUrl)}`;
            window.open(tweetUrl, '_blank');
        }


        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        predictButton.addEventListener('click', () => {
            showPage('predictionPage');
            renderAllSongs(); // æ¥½æ›²ãƒªã‚¹ãƒˆã‚’å†æç”»
            selectedSongs = []; // é¸æŠæ¸ˆã¿æ¥½æ›²ã‚’ãƒªã‚»ãƒƒãƒˆ
            updateSelectedSongsList(); // é¸æŠæ¸ˆã¿ãƒªã‚¹ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ
            initSortable(); // Sortable.jsã‚’åˆæœŸåŒ–
            predictionConfirmation.classList.add('hidden'); // æŠ•ç¨¿å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤ºã«
            submitPredictionButton.classList.remove('hidden'); // æŠ•ç¨¿ãƒœã‚¿ãƒ³ã‚’å†è¡¨ç¤º
            songSearchInput.value = ''; // æ¤œç´¢ãƒãƒ¼ã‚’ã‚¯ãƒªã‚¢
        });

        viewResultsButton.addEventListener('click', () => {
            showPage('resultsPage');
            renderResults(); // çµæœã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        });

        // ã€ŒXã«æŠ•ç¨¿ã™ã‚‹ã€ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ–°ã—ã„é–¢æ•°ã«ç´ä»˜ã‘
        submitPredictionButton.addEventListener('click', submitPredictionAndShareOnX);
        // shareOnXButton ã¯å‰Šé™¤ã•ã‚ŒãŸãŸã‚ã€ã“ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚‚ä¸è¦
        // shareOnXButton.addEventListener('click', sharePredictionOnX);

        shareYourResultsOnXButton.addEventListener('click', shareResultsOnX);

        backToTopFromPredictButton.addEventListener('click', () => showPage('topPage'));
        backToTopFromResultsButton.addEventListener('click', () => showPage('topPage'));

        // æ¤œç´¢å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        songSearchInput.addEventListener('input', (event) => {
            renderAllSongs(event.target.value);
        });

        // 1ç§’ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’æ›´æ–°
        const countdownInterval = setInterval(updateCountdown, 1000);

        // åˆæœŸè¡¨ç¤º
        updateCountdown();
        showPage('topPage'); // åˆæœŸè¡¨ç¤ºã¯ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸

        // ãƒšãƒ¼ã‚¸ã‚’é›¢ã‚Œã‚‹éš›ã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚’ã‚¯ãƒªã‚¢ (ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢)
        window.addEventListener('beforeunload', () => {
            clearInterval(countdownInterval);
        });
    </script>
</body>
</html>
